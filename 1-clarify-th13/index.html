<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ecommerce Starter (Plain JS)</title>
  <meta name="description" content="Self-contained e-commerce SPA starter with product grid, filters, detail view and cart." />
  <style>
    :root {
      --bg: #f5f7fb;
      --surface: #ffffff;
      --text: #1f2937;
      --muted: #6b7280;
      --border: #e5e7eb;
      --primary: #2563eb;
      --shadow: 0 6px 18px rgba(0,0,0,.08);
      --radius: 12px;
      --chip: #eef2ff;
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial;
      color: var(--text);
      background: linear-gradient(#f8fbff 0%, #f5f7fb 100%);
    }

    /* Layout */
    .container {
      display: grid;
      grid-template-columns: 280px 1fr;
      gap: 20px;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    @media (max-width: 980px) {
      .container { grid-template-columns: 1fr; }
      .filters { order: -1; padding-bottom: 12px; }
    }

    /* Header */
    header.site-header {
      position: sticky;
      top: 0;
      z-index: 40;
      background: #fff;
      border-bottom: 1px solid var(--border);
      padding: 12px 20px;
      display: flex;
      align-items: center;
      gap: 12px;
      justify-content: space-between;
    }
    .logo {
      font-weight: 700;
      font-size: 1.25rem;
      letter-spacing: .2px;
    }
    .header-actions {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .btn, .icon-btn {
      border: 1px solid var(--border);
      background: #fff;
      padding: 10px 14px;
      border-radius: 8px;
      cursor: pointer;
      font: inherit;
      color: var(--text);
    }
    .btn.primary {
      background: var(--primary);
      color: #fff;
      border: 1px solid var(--primary);
    }
    .badge {
      display: inline-block;
      min-width: 18px;
      padding: 2px 6px;
      font-size: 12px;
      border-radius: 999px;
      background: #111;
      color: #fff;
      margin-left: 6px;
    }

    /* Panels */
    .filters {
      background: #fff;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 16px;
      box-shadow: var(--shadow);
      align-self: start;
    }
    .filters h2 { margin: 0 0 8px 0; font-size: 1.05rem; }
    .filter-group { margin-bottom: 14px; }
    .filter-group label { display: block; font-weight: 600; margin-bottom: 6px; }
    .search-input, .range-input {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: #fff;
    }
    .category-list { display: grid; grid-template-columns: 1fr 1fr; gap: 6px; }
    .category-item { display: flex; align-items: center; gap: 6px; font-size: 14px; }
    .price-display { font-size: 12px; color: var(--muted); margin-top: 6px; }

    /* Grid */
    main.content { padding: 0 4px; }
    #productGrid { display: grid; grid-template-columns: repeat(auto-fill, minmax(210px, 1fr)); gap: 14px; }
    .card {
      border: 1px solid var(--border);
      background: #fff;
      border-radius: 12px;
      padding: 12px;
      display: flex;
      flex-direction: column;
      height: 100%;
    }
    .thumb {
      height: 120px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-weight: 700;
      margin-bottom: 8px;
    }
    .card h3 { margin: 6px 0 4px 0; font-size: 1rem; line-height: 1.25; }
    .card p { margin: 0 0 8px 0; color: var(--muted); font-size: 13px; }
    .row { display: flex; justify-content: space-between; align-items: center; }
    .price { font-weight: 700; }

    .card-actions { display: grid; grid-template-columns: 1fr 1fr; gap: 6px; margin-top: 6px; }

    /* Modals / Drawer */
    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,.4);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      z-index: 50;
    }
    .modal {
      width: min(720px, 92vw);
      max-height: 86vh;
      overflow: auto;
      background: #fff;
      border-radius: 12px;
      border: 1px solid var(--border);
      padding: 14px;
      box-shadow: 0 20px 40px rgba(0,0,0,.25);
    }
    .modal-header { display: flex; justify-content: space-between; align-items: center; gap: 8px; padding-bottom: 8px; border-bottom: 1px solid var(--border); }
    .modal-content { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; padding-top: 8px; }
    .modal-image {
      height: 260px;
      border-radius: 8px;
      background: linear-gradient(135deg, #ddd, #fff);
      display: flex; align-items: center; justify-content: center;
      color: #222; font-size: 28px; font-weight: 700;
    }
    .modal-details { display: flex; flex-direction: column; gap: 8px; }
    .modal-details h2 { margin: 0; }
    .modal-close { background: transparent; border: 0; font-size: 20px; cursor: pointer; }

    .cart-drawer {
      position: fixed; top: 0; bottom: 0; right: 0;
      width: 420px; max-width: 100vw;
      background: #fff; border-left: 1px solid var(--border);
      box-shadow: -10px 0 20px rgba(0,0,0,.08);
      padding: 14px;
      transform: translateX(115%);
      transition: transform .25s ease;
      z-index: 60;
    }
    .cart-drawer.open { transform: translateX(0); }
    .cart-header { display: flex; justify-content: space-between; align-items: center; padding-bottom: 8px; border-bottom: 1px solid var(--border); }
    .cart-items { list-style: none; padding: 0; margin: 10px 0; max-height: 48vh; overflow: auto; }
    .cart-item { display: grid; grid-template-columns: 1fr auto; gap: 8px; align-items: center; padding: 8px 0; border-bottom: 1px dashed var(--border); }
    .cart-item-title { font-size: 14px; }
    .cart-qty { display: inline-flex; align-items: center; gap: 6px; }
    .qty-btn { width: 26px; height: 26px; border-radius: 6px; border: 1px solid var(--border); background: #f8f8f8; cursor: pointer; }
    .cart-total { font-weight: 700; text-align: right; padding: 8px 0; }
    .cart-actions { display: flex; gap: 8px; }

    /* Utilities */
    .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); border: 0; }
    .hidden { display: none !important; }
  </style>
</head>
<body>
  <!-- Accessible skip link -->
  <a class="sr-only" href="#content" id="skip-link">Skip to products</a>

  <header class="site-header" aria-label="Site header">
    <div class="logo" aria-label="Site logo">ShopNova</div>
    <div class="header-actions">
      <button class="btn" id="filtersToggle" aria-controls="filtersPanel" aria-expanded="true">Filters</button>
      <button class="btn" id="cartBtn" aria-label="Open cart" aria-controls="cartDrawer" aria-expanded="false">
        Cart <span id="cartCount" class="badge" aria-live="polite">0</span>
      </button>
    </div>
  </header>

  <div class="container" id="layout">
    <!-- Filters Panel -->
    <aside class="filters" id="filtersPanel" aria-label="Filters panel">
      <h2>Filters</h2>

      <div class="filter-group" aria-label="Search products">
        <label for="search">Search</label>
        <input type="text" id="search" class="search-input" placeholder="Try 'lamp', 'backpack'..." autocomplete="off" />
      </div>

      <div class="filter-group" aria-label="Categories">
        <span style="font-weight:600; display:block; margin-bottom:6px;">Category</span>
        <div id="categoryFilters" class="category-list" role="group" aria-label="Product categories">
          <!-- dynamic -->
        </div>
      </div>

      <div class="filter-group" aria-label="Maximum price">
        <span style="font-weight:600; display:block; margin-bottom:6px;">Max price</span>
        <input type="range" id="maxPrice" class="range-input" min="0" max="200" step="1" value="200" aria-valuemin="0" aria-valuemax="200" />
        <div class="price-display">Up to $<span id="priceValue">200</span></div>
      </div>

      <div class="filter-group" aria-label="Clear filters">
        <button id="clearFilters" class="btn" title="Clear all filters">Clear filters</button>
      </div>
    </aside>

    <!-- Product Grid -->
    <section class="content" aria-label="Product listing">
      <section id="productGrid" aria-label="Product grid" style="min-height: 60vh;">
        <!-- Cards injected by JS -->
      </section>
      <div id="emptyState" class="hidden" role="status" aria-live="polite">
        No products match your filters.
      </div>
    </section>
  </div>

  <!-- Product Detail Modal -->
  <div class="modal-backdrop" id="detailBackdrop" hidden aria-hidden="true" aria-label="Product detail drawer">
    <div class="modal" role="dialog" aria-modal="true" id="productDetailModal" aria-label="Product details">
      <div class="modal-header">
        <strong id="detailTitle">Product Title</strong>
        <button class="modal-close" id="detailClose" aria-label="Close product details">✕</button>
      </div>
      <div class="modal-content">
        <div class="modal-image" id="detailImage" aria-label="Product image">Image</div>
        <div class="modal-details">
          <div id="detailPrice" style="font-size:1.25rem; font-weight:700;"></div>
          <div id="detailDesc" style="color:var(--muted); line-height:1.4;"></div>
          <div class="row" aria-label="Rating">
            <span id="detailRating"></span>
            <span id="detailStock" style="color:var(--muted);"></span>
          </div>
          <div class="cart-actions" style="margin-top:6px;">
            <button class="btn primary" id="detailAddToCart" aria-label="Add to cart">Add to cart</button>
            <button class="btn" id="detailClose2" aria-label="Close product details (alternate)">Close</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Cart Drawer -->
  <aside class="cart-drawer" id="cartDrawer" aria-label="Shopping cart" aria-live="polite" hidden>
    <div class="cart-header">
      <strong>Cart</strong>
      <button id="cartClose" class="btn" aria-label="Close cart">Close</button>
    </div>
    <ul id="cartItems" class="cart-items" aria-label="Cart items">
      <!-- items injected -->
    </ul>
    <div class="cart-total" aria-label="Cart total">
      Total: $<span id="cartTotal">0.00</span>
    </div>
    <div class="cart-actions" style="justify-content: space-between;">
      <button class="btn primary" id="checkoutBtn" aria-label="Checkout" disabled>Checkout</button>
      <button class="btn" id="clearCartBtn" aria-label="Clear cart">Clear</button>
    </div>
  </aside>

  <script>
    // Sample data
    const PRODUCTS = [
      {
        id: 'p1',
        name: 'Aurora Wireless Headphones',
        description: 'Premium Bluetooth headphones with 40h battery, rich sound, and comfortable design.',
        price: 99.99,
        currency: 'USD',
        category: 'Electronics',
        color: '#4f8ef7',
        rating: 4.5,
        stock: 12,
        tags: ['audio','bluetooth','wireless']
      },
      {
        id: 'p2',
        name: 'Sierra Smartwatch',
        description: 'Activity tracking smartwatch with GPS, heart-rate monitor, and 7-day battery.',
        price: 199.99,
        currency: 'USD',
        category: 'Electronics',
        color: '#e85d5d',
        rating: 4.2,
        stock: 8,
        tags: ['wearable','fitness']
      },
      {
        id: 'p3',
        name: 'Nimbus Hoodie',
        description: 'Cozy, breathable hoodie crafted from premium cotton blend.',
        price: 49.99,
        currency: 'USD',
        category: 'Apparel',
        color: '#2ecc71',
        rating: 4.6,
        stock: 25,
        tags: ['clothing','unisex']
      },
      {
        id: 'p4',
        name: 'Luma Desk Lamp',
        description: 'Energy-efficient LED desk lamp with adjustable brightness and warmth.',
        price: 29.99,
        currency: 'USD',
        category: 'Home',
        color: '#f1c40f',
        rating: 4.1,
        stock: 30,
        tags: ['lighting','office']
      },
      {
        id: 'p5',
        name: 'Voyage Backpack',
        description: 'Durable, water-resistant backpack with roomy compartments for daily use.',
        price: 69.99,
        currency: 'USD',
        category: 'Outdoor',
        color: '#9b59b6',
        rating: 4.4,
        stock: 15,
        tags: ['travel','bag']
      },
      {
        id: 'p6',
        name: 'Quill Notebook',
        description: 'A4 notebook with smooth cream pages and durable cover.',
        price: 12.99,
        currency: 'USD',
        category: 'Books',
        color: '#34495e',
        rating: 4.7,
        stock: 100,
        tags: ['stationery']
      },
      {
        id: 'p7',
        name: 'Flux Coffee Maker',
        description: 'Compact drip coffee maker with programmable timer and auto shut-off.',
        price: 89.99,
        currency: 'USD',
        category: 'Home',
        color: '#e67e22',
        rating: 4.3,
        stock: 18,
        tags: ['kitchen','appliance']
      },
      {
        id: 'p8',
        name: 'Zen Yoga Mat',
        description: 'Non-slip yoga mat with cushioning for comfortable workouts at home.',
        price: 25.0,
        currency: 'USD',
        category: 'Outdoor',
        color: '#27ae60',
        rating: 4.0,
        stock: 40,
        tags: ['fitness','wellness']
      }
    ];

    // State
    const state = {
      filters: {
        search: '',
        categories: new Set(),
        maxPrice: 200
      },
      cart: []
    };

    // Elements
    const productGrid = document.getElementById('productGrid');
    const emptyState = document.getElementById('emptyState');
    const searchInput = document.getElementById('search');
    const categoryFilters = document.getElementById('categoryFilters');
    const maxPriceInput = document.getElementById('maxPrice');
    const priceValue = document.getElementById('priceValue');
    const clearFiltersBtn = document.getElementById('clearFilters');
    const cartBtn = document.getElementById('cartBtn');
    const cartDrawer = document.getElementById('cartDrawer');
    const cartItemsEl = document.getElementById('cartItems');
    const cartTotalEl = document.getElementById('cartTotal');
    const cartCountEl = document.getElementById('cartCount');

    // Detail modal
    const detailBackdrop = document.getElementById('detailBackdrop');
    const productDetailModal = document.getElementById('productDetailModal');
    const detailTitle = document.getElementById('detailTitle');
    const detailImage = document.getElementById('detailImage');
    const detailPrice = document.getElementById('detailPrice');
    const detailDesc = document.getElementById('detailDesc');
    const detailRating = document.getElementById('detailRating');
    const detailStock = document.getElementById('detailStock');
    const detailAddToCartBtn = document.getElementById('detailAddToCart');
    const detailCloseBtn = document.getElementById('detailClose');
    const detailCloseBtnAlt = document.getElementById('detailClose2');

    // Helpers
    function formatPrice(n) {
      return '$' + Number(n).toFixed(2);
    }

    function computeCartTotal() {
      return state.cart.reduce((sum, item) => sum + item.product.price * item.quantity, 0);
    }

    function updateCartUI() {
      // render items
      cartItemsEl.innerHTML = '';
      if (state.cart.length === 0) {
        const li = document.createElement('li');
        li.textContent = 'Cart is empty';
        li.style.color = 'var(--muted)';
        cartItemsEl.appendChild(li);
        cartTotalEl.textContent = '0.00';
        cartDrawer.setAttribute('hidden', '');
        cartDrawer.classList.remove('open');
        cartCountEl.textContent = '0';
        document.getElementById('checkoutBtn').disabled = true;
        return;
      }
      state.cart.forEach((ci, idx) => {
        const li = document.createElement('li');
        li.className = 'cart-item';
        li.innerHTML = `
          <div>
            <div class="cart-item-title">${ci.product.name}</div>
            <div style="font-size:12px; color:var(--muted)">${ci.product.category} • ${formatPrice(ci.product.price)}</div>
          </div>
          <div class="cart-qty" aria-label="Quantity">
            <button class="qty-btn" data-action="decrease" data-index="${idx}">−</button>
            <span>${ci.quantity}</span>
            <button class="qty-btn" data-action="increase" data-index="${idx}">＋</button>
          </div>
        `;
        cartItemsEl.appendChild(li);
      });
      const total = computeCartTotal();
      cartTotalEl.textContent = total.toFixed(2);
      cartCountEl.textContent = state.cart.reduce((a,b)=>a+b.quantity, 0).toString();
      document.getElementById('checkoutBtn').disabled = false;
      // attach events for +/-
      cartItemsEl.querySelectorAll('.qty-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const idx = parseInt(e.currentTarget.getAttribute('data-index'), 10);
          const act = e.currentTarget.getAttribute('data-action');
          if (act === 'increase') {
            state.cart[idx].quantity += 1;
          } else {
            state.cart[idx].quantity -= 1;
            if (state.cart[idx].quantity <= 0) {
              state.cart.splice(idx, 1);
            }
          }
          updateCartUI();
        });
      });
    }

    function addToCart(product, qty = 1) {
      const existing = state.cart.find(c => c.product.id === product.id);
      if (existing) existing.quantity += qty;
      else state.cart.push({ product, quantity: qty });
      updateCartUI();
    }

    // Filters rendering
    function renderCategories() {
      const cats = Array.from(new Set(PRODUCTS.map(p => p.category)));
      // initialize state.filter categories
      cats.forEach(cat => state.filters.categories.add(cat)); // start with all selected
      categoryFilters.innerHTML = '';
      cats.forEach(cat => {
        const id = 'cat-' + cat.toLowerCase();
        const label = document.createElement('label');
        label.className = 'category-item';
        label.htmlFor = id;
        label.innerHTML = `
          <input type="checkbox" id="${id}" checked data-category="${cat}" />
          <span>${cat}</span>
        `;
        categoryFilters.appendChild(label);
      });
      // event listeners
      categoryFilters.querySelectorAll('input[type="checkbox"]').forEach(cb => {
        cb.addEventListener('change', (e) => {
          const cat = e.currentTarget.getAttribute('data-category');
          if (e.currentTarget.checked) {
            state.filters.categories.add(cat);
          } else {
            state.filters.categories.delete(cat);
          }
          renderGrid();
        });
      });
    }

    // Grid rendering
    function renderGrid() {
      const q = (state.filters.search || '').toLowerCase().trim();
      const cats = state.filters.categories;
      const maxP = state.filters.maxPrice;
      // filter
      let items = PRODUCTS.filter(p => {
        const matchQuery = !q || p.name.toLowerCase().includes(q) || p.description.toLowerCase().includes(q);
        const matchCat = cats.has(p.category);
        const matchPrice = p.price <= maxP;
        return matchQuery && matchCat && matchPrice;
      });

      productGrid.innerHTML = '';
      if (items.length === 0) {
        emptyState.classList.remove('hidden');
      } else {
        emptyState.classList.add('hidden');
      }

      items.forEach(prod => {
        const card = document.createElement('article');
        card.className = 'card';
        card.role = 'article';
        // create simple image block with color gradient
        const imageBlock = document.createElement('div');
        imageBlock.className = 'thumb';
        imageBlock.style.background = `linear-gradient(135deg, ${prod.color}, #ffffff)`;
        imageBlock.setAttribute('aria-label', prod.name + ' image');
        imageBlock.style.height = '110px';
        imageBlock.style.borderRadius = '8px';
        const imgLabel = document.createElement('span');
        imgLabel.style.fontWeight = '700';
        imgLabel.style.color = '#fff';
        imgLabel.style.textShadow = '0 1px 2px rgba(0,0,0,.25)';
        imgLabel.textContent = prod.name.split(' ').slice(0,2).map(w => w[0]).join('');
        imageBlock.appendChild(imgLabel);

        const title = document.createElement('h3');
        title.textContent = prod.name;

        const desc = document.createElement('p');
        desc.textContent = prod.description;

        const price = document.createElement('div');
        price.className = 'price';
        price.textContent = formatPrice(prod.price);

        const rating = document.createElement('div');
        rating.style.fontSize = '12px';
        rating.style.color = 'var(--muted)';
        rating.textContent = 'Rating: ' + prod.rating.toFixed(1) + ' / 5 • Stock: ' + prod.stock;

        const btnRow = document.createElement('div');
        btnRow.className = 'card-actions';

        const viewBtn = document.createElement('button');
        viewBtn.className = 'btn';
        viewBtn.textContent = 'View';
        viewBtn.addEventListener('click', () => openDetail(prod, viewBtn));

        const addBtn = document.createElement('button');
        addBtn.className = 'btn primary';
        addBtn.textContent = 'Add to cart';
        addBtn.addEventListener('click', () => {
          addToCart(prod, 1);
        });

        btnRow.appendChild(viewBtn);
        btnRow.appendChild(addBtn);

        card.appendChild(imageBlock);
        card.appendChild(title);
        card.appendChild(desc);
        card.appendChild(price);
        card.appendChild(rating);
        card.appendChild(btnRow);

        productGrid.appendChild(card);
      });
    }

    // Detail modal
    function openDetail(product, triggerElement) {
      detailTitle.textContent = product.name;
      detailPrice.textContent = formatPrice(product.price) + ' • ' + product.category;
      detailDesc.textContent = product.description;
      detailRating.textContent = 'Rating: ' + product.rating.toFixed(1) + ' / 5';
      detailStock.textContent = 'Stock: ' + product.stock;
      detailAddToCartBtn.onclick = () => { addToCart(product, 1); closeDetail(); };

      // detail image
      detailImage.innerHTML = '';
      const img = document.createElement('div');
      img.style.width = '100%';
      img.style.height = '100%';
      img.style.borderRadius = '8px';
      img.style.background = `linear-gradient(135deg, ${product.color}, #fff)`;
      img.style.display = 'flex';
      img.style.alignItems = 'center';
      img.style.justifyContent = 'center';
      img.style.color = '#fff';
      img.style.fontWeight = '700';
      img.textContent = product.name.split(' ').slice(0,2).map(w => w[0]).join('');
      detailImage.appendChild(img);

      // show modal
      detailBackdrop.hidden = false;
      detailBackdrop.removeAttribute('aria-hidden');
      // trap focus
      const focusable = getFocusable(detailBackdrop);
      const first = focusable[0];
      const focusableInside = () => detailBackdrop.querySelectorAll('button, [href], input, [tabindex]:not([tabindex="-1"])');
      const inside = focusableInside();
      if (first) first.focus();

      function trap(e) {
        if (e.key === 'Escape') {
          closeDetail();
        }
        if (e.key === 'Tab') {
          const focusables = inside;
          if (focusables.length === 0) { e.preventDefault(); return; }
          const firstEl = focusables[0];
          const lastEl = focusables[focusables.length - 1];
          if (e.shiftKey && document.activeElement === firstEl) {
            lastEl.focus();
            e.preventDefault();
          } else if (!e.shiftKey && document.activeElement === lastEl) {
            firstEl.focus();
            e.preventDefault();
          }
        }
      }
      detailBackdrop.addEventListener('keydown', trap);
      function detach() {
        detailBackdrop.removeEventListener('keydown', trap);
      }
      function closeAndDetach() {
        closeDetail();
        detach();
      }

      // close handlers
      function closeDetail() {
        detailBackdrop.hidden = true;
        detailBackdrop.setAttribute('aria-hidden', 'true');
        detailBackdrop.removeEventListener('keydown', trap);
        if (triggerElement) triggerElement.focus();
      }

      // attach inner close actions
      detailCloseBtn.addEventListener('click', closeDetail);
      detailCloseBtnAlt.addEventListener('click', closeDetail);
      // also close by backdrop click
      detailBackdrop.addEventListener('click', (ev) => {
        if (ev.target === detailBackdrop) closeDetail();
      }, { once: true });
    }

    function getFocusable(container) {
      if (!container) return [];
      return container.querySelectorAll(
        'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
      );
    }

    // Event wiring
    function bindGlobalShortcuts() {
      // Open cart with keyboard
      cartBtn.addEventListener('click', () => {
        cartDrawer.classList.add('open');
        cartDrawer.removeAttribute('hidden');
        cartDrawer.setAttribute('aria-hidden', 'false');
        cartDrawer.focus?.();
        cartDrawer.style.outline = 'none';
        cartDrawer.classList.add('open');
        updateCartUI();
      });

      // Keyboard: ESC closes cart
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          if (!detailBackdrop.hidden) closeDetail();
          if (!cartDrawer.hasAttribute('hidden')) {
            cartDrawer.classList.remove('open');
            cartDrawer.setAttribute('hidden', '');
            cartDrawer.setAttribute('aria-hidden', 'true');
          }
        }
      });
    }

    // Clear filters
    clearFiltersBtn.addEventListener('click', () => {
      // reset UI
      searchInput.value = '';
      state.filters.search = '';
      // all categories re-checked
      state.filters.categories = new Set(PRODUCTS.map(p => p.category));
      // max price to max
      maxPriceInput.value = 200;
      state.filters.maxPrice = 200;
      // update checkboxes to checked
      categoryFilters.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = true);
      renderGrid();
    });

    // Input handlers
    searchInput.addEventListener('input', (e) => {
      state.filters.search = e.target.value;
      renderGrid();
    });

    maxPriceInput.addEventListener('input', (e) => {
      const v = Math.max(0, Math.min(200, Number(e.target.value)));
      state.filters.maxPrice = v;
      priceValue.textContent = v.toFixed(0);
      renderGrid();
    });

    // Cart actions
    document.getElementById('checkoutBtn').addEventListener('click', () => {
      // Simple mock checkout
      alert('Checkout flow would proceed here. This is a starter scaffold.');
    });
    document.getElementById('cartClose').addEventListener('click', () => {
      cartDrawer.classList.remove('open');
      cartDrawer.setAttribute('hidden', '');
      cartDrawer.setAttribute('aria-hidden', 'true');
    });
    document.getElementById('clearCartBtn').addEventListener('click', () => {
      state.cart = [];
      updateCartUI();
    });

    // Detail close helpers
    function closeDetail() {
      detailBackdrop.hidden = true;
      detailBackdrop.setAttribute('aria-hidden', 'true');
    }

    // Initialize
    function init() {
      // render categories and grid
      renderCategories();
      renderGrid();
      updateCartUI();
      // Focus management
      document.getElementById('filtersToggle').addEventListener('click', () => {
        // simple toggle visual (filters panel is always visible in this minimal layout)
      });

      bindGlobalShortcuts();
    }

    // Start
    init();
  </script>
</body>
</html>