<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nordic Stream | Essential Living</title>
    <script>
        // Early theme application to prevent flash
        (function() {
            const savedTheme = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
            document.documentElement.setAttribute('data-theme', savedTheme);
        })();
    </script>
    <style>
        :root {
            /* Design Tokens - Light */
            --bg: #ffffff;
            --bg-alt: #f4f7f9; /* Soft pastel blue-grey band */
            --bg-alt-2: #f9f6f2; /* Soft pastel sand band */
            --surface: #ffffff;
            --text: #1a1a1a;
            --muted: #666666;
            --border: #e5e5e5;
            --primary: #005bb7; /* Business Blue */
            --primary-hover: #00448a;
            --on-primary: #ffffff;
            --accent: #008080;
            --success: #2e7d32;
            --danger: #d32f2f;
            --focus: #005bb7;
            
            --max-width: 900px;
            --space-1: 4px;
            --space-2: 8px;
            --space-3: 16px;
            --space-4: 24px;
            --space-5: 48px;
            --space-6: 80px;
            
            --font-size-1: 12px;
            --font-size-2: 14px;
            --font-size-3: 16px;
            --font-size-4: 20px;
            --font-size-5: 32px;
            --font-size-6: 48px;
            
            --radius-btn: 3px;
            --transition: 200ms ease;
        }

        [data-theme="dark"] {
            --bg: #121212;
            --bg-alt: #1a1e22;
            --bg-alt-2: #1e1c1a;
            --surface: #121212;
            --text: #eeeeee;
            --muted: #aaaaaa;
            --border: #2d2d2d;
            --primary: #47a1ff;
            --primary-hover: #70b8ff;
            --on-primary: #121212;
            --focus: #47a1ff;
        }

        /* Base Styles */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }

        button {
            font-family: Arial, sans-serif;
            cursor: pointer;
            border: none;
            background: none;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-btn);
            font-size: var(--font-size-3);
        }

        button:focus-visible {
            outline: 2px solid var(--focus);
            outline-offset: 2px;
        }

        img {
            max-width: 100%;
            display: block;
            border-radius: 0;
        }

        /* Layout */
        .container {
            max-width: var(--max-width);
            margin: 0 auto;
            padding: 0 var(--space-4);
        }

        section {
            padding: var(--space-6) 0;
        }

        .full-width-band {
            width: 100%;
        }

        .band-alt { background-color: var(--bg-alt); }
        .band-alt-2 { background-color: var(--bg-alt-2); }

        /* Header */
        header {
            padding: var(--space-4) 0;
            position: sticky;
            top: 0;
            background: var(--bg);
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .brand {
            font-size: var(--font-size-4);
            font-weight: bold;
            color: var(--primary);
            text-decoration: none;
            text-transform: none;
        }

        .nav-actions {
            display: flex;
            gap: var(--space-3);
            align-items: center;
        }

        /* Buttons */
        .btn-primary {
            background-color: var(--primary);
            color: var(--on-primary);
            padding: 12px 24px;
            font-weight: bold;
        }

        .btn-primary:hover {
            background-color: var(--primary-hover);
        }

        .btn-outline {
            border: 1px solid var(--primary);
            color: var(--primary);
            padding: 10px 20px;
        }

        .btn-icon {
            padding: var(--space-2);
            color: var(--text);
        }

        /* Hero */
        .hero {
            text-align: center;
            padding-top: var(--space-5);
        }

        .hero h1 {
            font-size: var(--font-size-6);
            line-height: 1.1;
            margin-bottom: var(--space-3);
        }

        .hero p {
            font-size: var(--font-size-4);
            color: var(--muted);
            margin-bottom: var(--space-4);
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .hero-image {
            margin-top: var(--space-5);
            width: 100%;
            height: 400px;
            object-fit: cover;
        }

        /* Categories */
        .category-list {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: var(--space-3);
            margin-top: var(--space-4);
        }

        .category-item {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            font-size: var(--font-size-4);
            padding: var(--space-2) 0;
            border-bottom: 1px solid transparent;
            text-decoration: none;
            color: var(--text);
            transition: var(--transition);
        }

        .category-item:hover {
            color: var(--primary);
            padding-left: var(--space-2);
        }

        .category-icon {
            width: 24px;
            height: 24px;
            color: var(--primary);
        }

        /* Products */
        .filter-bar {
            margin-bottom: var(--space-5);
            display: flex;
            gap: var(--space-3);
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: var(--space-2) 0;
            margin-right: var(--space-4);
            color: var(--muted);
            font-weight: bold;
            border-bottom: 2px solid transparent;
            border-radius: 0;
        }

        .filter-btn.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .product-list {
            display: flex;
            flex-direction: column;
            gap: var(--space-6);
        }

        .product-item {
            display: flex;
            flex-direction: column;
            gap: var(--space-4);
        }

        .product-img-wrapper {
            width: 100%;
            aspect-ratio: 16/9;
            overflow: hidden;
            background: var(--bg-alt);
        }

        .product-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .product-item:hover .product-img {
            transform: scale(1.02);
        }

        .product-info {
            display: flex;
            flex-direction: column;
            gap: var(--space-2);
        }

        .product-category {
            font-size: var(--font-size-1);
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--muted);
        }

        .product-name {
            font-size: var(--font-size-4);
            font-weight: bold;
        }

        .product-price {
            font-size: var(--font-size-3);
            color: var(--primary);
            font-weight: bold;
        }

        /* Cart Section */
        #cart-section {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease-in-out;
            background: var(--bg-alt);
        }

        #cart-section.open {
            max-height: 2000px;
            padding: var(--space-5) 0;
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-3) 0;
            border-bottom: 1px solid var(--border);
        }

        .cart-total {
            margin-top: var(--space-4);
            text-align: right;
            font-size: var(--font-size-4);
            font-weight: bold;
        }

        /* Testimonials */
        .testimonial-item {
            margin-bottom: var(--space-5);
        }

        .testimonial-text {
            font-size: var(--font-size-4);
            font-style: italic;
            margin-bottom: var(--space-2);
        }

        .testimonial-author {
            font-weight: bold;
            color: var(--primary);
        }

        /* Newsletter */
        .newsletter-form {
            display: flex;
            flex-direction: column;
            gap: var(--space-3);
            max-width: 500px;
            margin-top: var(--space-4);
        }

        input {
            padding: 14px;
            border: 1px solid var(--border);
            background: var(--bg);
            color: var(--text);
            font-family: Arial, sans-serif;
            font-size: var(--font-size-3);
            border-radius: 0;
        }

        input:focus {
            outline: 2px solid var(--focus);
            border-color: transparent;
        }

        /* Footer */
        footer {
            padding: var(--space-6) 0;
            border-top: 1px solid var(--border);
            color: var(--muted);
            font-size: var(--font-size-2);
        }

        .footer-content {
            display: flex;
            flex-direction: column;
            gap: var(--space-4);
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: var(--space-4);
        }

        .modal-content {
            background: var(--bg);
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            padding: var(--space-5);
        }

        .modal-close {
            position: absolute;
            top: var(--space-3);
            right: var(--space-3);
            font-size: 24px;
        }

        /* Toasts */
        .toast-container {
            position: fixed;
            bottom: var(--space-4);
            left: 50%;
            transform: translateX(-50%);
            z-index: 2000;
            display: flex;
            flex-direction: column;
            gap: var(--space-2);
        }

        .toast {
            background: var(--text);
            color: var(--bg);
            padding: 12px 24px;
            font-size: var(--font-size-2);
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* Utilities */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            border: 0;
        }
    </style>
</head>
<body>

    <header>
        <div class="container header-content">
            <a href="#" class="brand">Nordic Stream</a>
            <div class="nav-actions">
                <button id="theme-toggle" class="btn-icon" aria-label="Toggle dark mode">
                    <svg class="category-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
                </button>
                <button id="cart-toggle" class="btn-icon" aria-label="View shopping cart">
                    <svg class="category-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path></svg>
                    <span id="cart-count" style="margin-left: 4px; font-weight: bold;">0</span>
                </button>
            </div>
        </div>
    </header>

    <div id="cart-section" role="region" aria-label="Shopping Cart">
        <div class="container">
            <h2 style="margin-bottom: var(--space-4)">Your Cart</h2>
            <div id="cart-items-container">
                <!-- Cart items injected here -->
                <p style="color: var(--muted)">Your cart is currently empty.</p>
            </div>
            <div id="cart-summary" style="display: none;">
                <div class="cart-total">Total: $<span id="cart-total-value">0.00</span></div>
                <div style="display: flex; gap: var(--space-3); justify-content: flex-end; margin-top: var(--space-4);">
                    <button class="btn-outline" onclick="clearCart()">Clear Cart</button>
                    <button class="btn-primary" onclick="checkout()">Checkout</button>
                </div>
            </div>
        </div>
    </div>

    <main>
        <section class="hero">
            <div class="container">
                <h1>Quiet Design for Loud Lives.</h1>
                <p>Curated minimalist essentials for the modern home, designed in Stockholm and built to last a lifetime.</p>
                <button class="btn-primary" onclick="document.getElementById('featured-products').scrollIntoView({behavior: 'smooth'})">Shop the Collection</button>
                <img src="https://images.unsplash.com/photo-1583847268964-b28dc8f51f92?auto=format&fit=crop&q=80&w=1200" alt="Minimalist living room with neutral tones" class="hero-image">
            </div>
        </section>

        <section class="full-width-band band-alt">
            <div class="container">
                <h2 style="margin-bottom: var(--space-4)">Browse by Category</h2>
                <nav class="category-list">
                    <a href="#" class="category-item" onclick="filterByCategory('Kitchenware', event)">
                        <svg class="category-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364-6.364l-.707.707M6.343 17.657l-.707.707m12.728 0l-.707-.707M6.343 6.343l-.707-.707"></path></svg>
                        Kitchenware
                    </a>
                    <a href="#" class="category-item" onclick="filterByCategory('Textiles', event)">
                        <svg class="category-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path></svg>
                        Textiles
                    </a>
                    <a href="#" class="category-item" onclick="filterByCategory('Lighting', event)">
                        <svg class="category-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path></svg>
                        Lighting
                    </a>
                    <a href="#" class="category-item" onclick="filterByCategory('Furniture', event)">
                        <svg class="category-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>
                        Furniture
                    </a>
                </nav>
            </div>
        </section>

        <section id="featured-products">
            <div class="container">
                <div class="filter-bar">
                    <button class="filter-btn active" onclick="filterByCategory('all', event)">All Products</button>
                    <button class="filter-btn" onclick="filterByCategory('Kitchenware', event)">Kitchenware</button>
                    <button class="filter-btn" onclick="filterByCategory('Textiles', event)">Textiles</button>
                    <button class="filter-btn" onclick="filterByCategory('Lighting', event)">Lighting</button>
                    <button class="filter-btn" onclick="filterByCategory('Furniture', event)">Furniture</button>
                </div>
                
                <div id="product-grid" class="product-list">
                    <!-- Products injected here -->
                </div>
            </div>
        </section>

        <section class="full-width-band band-alt-2">
            <div class="container">
                <h2 style="margin-bottom: var(--space-5)">What our community says</h2>
                <div class="testimonial-item">
                    <p class="testimonial-text">"The quality of the linen throw is exceptional. It has a weight and texture that you just don't find in mass-market stores."</p>
                    <p class="testimonial-author">Elena G., Copenhagen</p>
                </div>
                <div class="testimonial-item">
                    <p class="testimonial-text">"Minimalist design that actually functions perfectly. The Arctic Kettle is now the center of my kitchen."</p>
                    <p class="testimonial-author">Marcus L., Oslo</p>
                </div>
            </div>
        </section>

        <section>
            <div class="container">
                <h2>Join the stream</h2>
                <p style="color: var(--muted); margin-top: var(--space-2)">Receive monthly updates on new collections and slow-living stories.</p>
                <form class="newsletter-form" onsubmit="handleNewsletter(event)">
                    <label for="email-input" class="sr-only">Email Address</label>
                    <input type="email" id="email-input" placeholder="Enter your email address" required>
                    <button type="submit" class="btn-primary">Subscribe</button>
                </form>
            </div>
        </section>
    </main>

    <footer>
        <div class="container footer-content">
            <div class="brand">Nordic Stream</div>
            <p>&copy; 2024 Nordic Stream. All rights reserved.</p>
            <p>Shipping & Returns • Privacy Policy • Terms of Service</p>
        </div>
    </footer>

    <!-- Modal System -->
    <div id="modal-overlay" class="modal-overlay" role="dialog" aria-modal="true">
        <div class="modal-content" id="modal-content">
            <button class="modal-close" onclick="closeModal()" aria-label="Close modal">&times;</button>
            <div id="modal-body"></div>
        </div>
    </div>

    <!-- Toast System -->
    <div id="toast-container" class="toast-container"></div>

    <script>
        // Data
        const products = [
            { id: 1, name: "Arctic Kettle", category: "Kitchenware", price: 120.00, img: "https://images.unsplash.com/photo-1594910411242-990799403884?auto=format&fit=crop&q=80&w=800", desc: "A matte black stainless steel kettle with precision temperature control and a silent boil feature." },
            { id: 2, name: "Fjord Linen Throw", category: "Textiles", price: 85.00, img: "https://images.unsplash.com/photo-1520004434532-668416a08753?auto=format&fit=crop&q=80&w=800", desc: "Heavyweight 100% organic linen throw in a soft stone grey. Pre-washed for ultimate softness." },
            { id: 3, name: "Midnight Brass Lamp", category: "Lighting", price: 210.00, img: "https://images.unsplash.com/photo-1534073828943-f801091bb270?auto=format&fit=crop&q=80&w=800", desc: "Hand-brushed brass table lamp with a dimmable warm LED bulb. A sculptural piece for any desk." },
            { id: 4, name: "Solid Oak Stool", category: "Furniture", price: 340.00, img: "https://images.unsplash.com/photo-1503602642458-232111445657?auto=format&fit=crop&q=80&w=800", desc: "Crafted from a single block of sustainable European oak. Natural oil finish." },
            { id: 5, name: "Ceramic Pour-Over Set", category: "Kitchenware", price: 65.00, img: "https://images.unsplash.com/photo-1544787210-228394c3d3e2?auto=format&fit=crop&q=80&w=800", desc: "Hand-glazed ceramic dripper and server set. Designed for the perfect morning ritual." },
            { id: 6, name: "Wool Felt Desk Mat", category: "Textiles", price: 45.00, img: "https://images.unsplash.com/photo-1616418181419-f958a8d30753?auto=format&fit=crop&q=80&w=800", desc: "Merino wool felt mat that protects your workspace and provides a warm, tactile surface." },
            { id: 7, name: "Glass Water Carafe", category: "Kitchenware", price: 38.00, img: "https://images.unsplash.com/photo-1616627561839-074385245ff6?auto=format&fit=crop&q=80&w=800", desc: "Mouth-blown crystalline glass with a minimalist cork stopper. Elegant hydration." },
            { id: 8, name: "Brushed Steel Cutlery", category: "Kitchenware", price: 150.00, img: "https://images.unsplash.com/photo-1591192849220-410a8047917c?auto=format&fit=crop&q=80&w=800", desc: "24-piece set in matte brushed steel. Balanced weight and timeless silhouette." }
        ];

        let cart = JSON.parse(localStorage.getItem('ns_cart')) || [];
        let currentFilter = 'all';

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            renderProducts();
            updateCartUI();
            setupTheme();
        });

        // Theme Logic
        function setupTheme() {
            const toggle = document.getElementById('theme-toggle');
            toggle.addEventListener('click', () => {
                const current = document.documentElement.getAttribute('data-theme');
                const next = current === 'light' ? 'dark' : 'light';
                document.documentElement.setAttribute('data-theme', next);
                localStorage.setItem('theme', next);
            });
        }

        // Product Rendering
        function renderProducts() {
            const grid = document.getElementById('product-grid');
            const filtered = currentFilter === 'all' ? products : products.filter(p => p.category === currentFilter);
            
            grid.innerHTML = filtered.map(product => `
                <article class="product-item">
                    <div class="product-img-wrapper" onclick="showProductDetail(${product.id})">
                        <img src="${product.img}" alt="${product.name}" class="product-img" loading="lazy">
                    </div>
                    <div class="product-info">
                        <span class="product-category">${product.category}</span>
                        <h3 class="product-name">${product.name}</h3>
                        <p class="product-price">$${product.price.toFixed(2)}</p>
                        <button class="btn-primary" style="margin-top: var(--space-2); align-self: flex-start;" onclick="addToCart(${product.id})">Add to Cart</button>
                    </div>
                </article>
            `).join('');
        }

        function filterByCategory(cat, e) {
            e.preventDefault();
            currentFilter = cat;
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.toggle('active', btn.innerText.includes(cat) || (cat === 'all' && btn.innerText === 'All Products'));
            });
            renderProducts();
            if (cat !== 'all') {
                document.getElementById('featured-products').scrollIntoView({behavior: 'smooth'});
            }
        }

        // Cart Logic
        const cartToggle = document.getElementById('cart-toggle');
        const cartSection = document.getElementById('cart-section');

        cartToggle.addEventListener('click', () => {
            cartSection.classList.toggle('open');
        });

        function addToCart(id) {
            const product = products.find(p => p.id === id);
            const existing = cart.find(item => item.id === id);
            
            if (existing) {
                existing.quantity += 1;
            } else {
                cart.push({ ...product, quantity: 1 });
            }
            
            saveCart();
            updateCartUI();
            showToast(`Added ${product.name} to cart`);
        }

        function updateQuantity(id, delta) {
            const item = cart.find(i => i.id === id);
            if (item) {
                item.quantity += delta;
                if (item.quantity <= 0) {
                    cart = cart.filter(i => i.id !== id);
                }
                saveCart();
                updateCartUI();
            }
        }

        function clearCart() {
            showConfirmModal("Are you sure you want to clear your cart?", () => {
                cart = [];
                saveCart();
                updateCartUI();
                showToast("Cart cleared");
            });
        }

        function saveCart() {
            localStorage.setItem('ns_cart', JSON.stringify(cart));
        }

        function updateCartUI() {
            const container = document.getElementById('cart-items-container');
            const count = document.getElementById('cart-count');
            const summary = document.getElementById('cart-summary');
            const totalVal = document.getElementById('cart-total-value');

            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            count.innerText = totalItems;

            if (cart.length === 0) {
                container.innerHTML = '<p style="color: var(--muted)">Your cart is currently empty.</p>';
                summary.style.display = 'none';
            } else {
                summary.style.display = 'block';
                container.innerHTML = cart.map(item => `
                    <div class="cart-item">
                        <div>
                            <div style="font-weight: bold;">${item.name}</div>
                            <div style="font-size: var(--font-size-2); color: var(--muted);">$${item.price.toFixed(2)}</div>
                        </div>
                        <div style="display: flex; align-items: center; gap: var(--space-3);">
                            <div style="display: flex; align-items: center; gap: var(--space-2);">
                                <button class="btn-icon" onclick="updateQuantity(${item.id}, -1)" aria-label="Decrease quantity">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="2" d="M20 12H4"></path></svg>
                                </button>
                                <span>${item.quantity}</span>
                                <button class="btn-icon" onclick="updateQuantity(${item.id}, 1)" aria-label="Increase quantity">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
                                </button>
                            </div>
                            <button class="btn-icon" style="color: var(--danger)" onclick="removeFromCart(${item.id})" aria-label="Remove item">
                                <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                            </button>
                        </div>
                    </div>
                `).join('');

                const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                totalVal.innerText = total.toFixed(2);
            }
        }

        function removeFromCart(id) {
            cart = cart.filter(item => item.id !== id);
            saveCart();
            updateCartUI();
            showToast("Item removed");
        }

        function checkout() {
            showModal("Order Success", `
                <div style="text-align: center;">
                    <svg style="width: 64px; height: 64px; color: var(--success); margin-bottom: var(--space-4);" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    <h3>Thank you for your order!</h3>
                    <p style="margin: var(--space-3) 0; color: var(--muted);">Your order has been received and is being processed. You will receive a confirmation email shortly.</p>
                    <button class="btn-primary" onclick="closeModal(); clearCartData();">Back to Store</button>
                </div>
            `);
        }

        function clearCartData() {
            cart = [];
            saveCart();
            updateCartUI();
            cartSection.classList.remove('open');
        }

        // Modal Logic
        const modalOverlay = document.getElementById('modal-overlay');
        const modalBody = document.getElementById('modal-body');

        function showModal(title, content) {
            modalBody.innerHTML = content;
            modalOverlay.style.display = 'flex';
            document.body.style.overflow = 'hidden';
            
            // Focus trap
            const focusable = modalOverlay.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
            if (focusable.length) focusable[0].focus();
        }

        function closeModal() {
            modalOverlay.style.display = 'none';
            document.body.style.overflow = '';
        }

        function showProductDetail(id) {
            const p = products.find(item => item.id === id);
            showModal(p.name, `
                <div style="display: flex; flex-direction: column; gap: var(--space-4);">
                    <img src="${p.img}" alt="${p.name}" style="width: 100%; height: 300px; object-fit: cover;">
                    <div>
                        <span class="product-category">${p.category}</span>
                        <h2 style="margin: var(--space-1) 0">${p.name}</h2>
                        <p style="font-size: var(--font-size-4); font-weight: bold; color: var(--primary);">$${p.price.toFixed(2)}</p>
                        <p style="margin: var(--space-3) 0; color: var(--muted);">${p.desc}</p>
                        <div style="margin-top: var(--space-4); display: flex; gap: var(--space-3);">
                            <button class="btn-primary" onclick="addToCart(${p.id}); closeModal();">Add to Cart</button>
                            <button class="btn-outline" onclick="closeModal()">Close</button>
                        </div>
                    </div>
                </div>
            `);
        }

        function showConfirmModal(message, onConfirm) {
            showModal("Confirm Action", `
                <div style="text-align: center;">
                    <p style="margin-bottom: var(--space-4); font-size: var(--font-size-3);">${message}</p>
                    <div style="display: flex; gap: var(--space-3); justify-content: center;">
                        <button class="btn-outline" onclick="closeModal()">Cancel</button>
                        <button class="btn-primary" id="confirm-btn">Confirm</button>
                    </div>
                </div>
            `);
            document.getElementById('confirm-btn').onclick = () => {
                onConfirm();
                closeModal();
            };
        }

        // Toast Logic
        function showToast(message) {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.innerText = message;
            container.appendChild(toast);
            
            setTimeout(() => {
                toast.style.opacity = '0';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // Form Logic
        function handleNewsletter(e) {
            e.preventDefault();
            const email = document.getElementById('email-input').value;
            showModal("Subscription Successful", `
                <div style="text-align: center;">
                    <h3 style="margin-bottom: var(--space-3)">Welcome to the stream.</h3>
                    <p style="color: var(--muted);">We've added <strong>${email}</strong> to our list. Expect our next update on the first Monday of the month.</p>
                    <button class="btn-primary" style="margin-top: var(--space-4)" onclick="closeModal()">Great</button>
                </div>
            `);
            e.target.reset();
        }

        // Accessibility: Close modal on ESC
        window.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && modalOverlay.style.display === 'flex') {
                closeModal();
            }
        });

        // Click outside modal to close
        modalOverlay.addEventListener('click', (e) => {
            if (e.target === modalOverlay) closeModal();
        });
    </script>
</body>
</html>